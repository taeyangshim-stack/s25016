# 용접선 검증 분석 도구 설치 가이드

## 📦 필수 요구사항

- Python 3.7 이상
- pip (Python 패키지 관리자)

## 🚀 설치 방법

### Windows

```cmd
# 1. Python이 설치되어 있는지 확인
python --version

# 2. 필요한 라이브러리 설치
pip install -r requirements.txt

# 또는 개별 설치
pip install openpyxl
```

### Linux / Mac

```bash
# 1. Python이 설치되어 있는지 확인
python3 --version

# 2. 필요한 라이브러리 설치
pip3 install -r requirements.txt

# 또는 개별 설치
pip3 install openpyxl
```

## 📝 사용 방법

### Excel 분석 도구 실행

```bash
# Windows
python analyze_logs_excel.py

# Linux / Mac
python3 analyze_logs_excel.py
```

### 간단 버전 (터미널 출력 + CSV)

```bash
# Windows
python analyze_logs.py --csv

# Linux / Mac
python3 analyze_logs.py --csv
```

## 📂 파일 구조

```
weld-line-check/
├── requirements.txt              # 필요한 라이브러리 목록
├── 설치가이드.md                 # 이 파일
├── analyze_logs_excel.py         # Excel 분석 도구 (추천)
├── analyze_logs.py               # 간단 버전 (터미널 + CSV)
├── test_validator.py             # 상세 디버깅 도구
├── BUG_REPORT.md                 # 버그 분석 보고서
├── B라인1번거더/                 # 로그 파일 폴더
│   └── 02월/
│       └── 04일/
│           └── rcs_20260204.log
├── B라인2번거더/
└── B라인3번거더/
```

## 🎯 출력 파일

### Excel 파일 (analyze_logs_excel.py)
- 파일명: `용접선검증_B라인1번거더_20260207_103441.xlsx`
- 탭 구성:
  - **요약**: 거더정보, 날짜, 기준값, 통계
  - **전체 데이터**: 모든 검증 결과 (필터 적용)
  - **FAIL만**: 불합격 케이스만 모음
  - **통계**: 평균, 최소, 최대, 중앙값

### CSV 파일 (analyze_logs.py --csv)
- 파일명: `validation_results_20260207_102638.csv`
- Excel에서 열기 가능

## 🔧 문제 해결

### openpyxl 설치 오류

```bash
# 업그레이드
pip install --upgrade pip
pip install --upgrade openpyxl

# 관리자 권한으로 설치 (Windows)
python -m pip install --user openpyxl

# sudo 사용 (Linux/Mac)
sudo pip3 install openpyxl
```

### Python 버전 오류

Python 3.7 이상이 필요합니다. 최신 버전 설치:
- Windows: https://www.python.org/downloads/
- Linux: `sudo apt install python3.9`
- Mac: `brew install python@3.9`

### 파일 인코딩 오류

로그 파일이 UTF-8이 아닌 경우:
```python
# analyze_logs_excel.py 수정
with open(log_file, 'r', encoding='utf-8') as f:
# → 다음으로 변경
with open(log_file, 'r', encoding='cp949') as f:  # 또는 'euc-kr'
```

## 📞 지원

문제가 발생하면:
1. Python 버전 확인: `python --version`
2. pip 버전 확인: `pip --version`
3. 라이브러리 설치 확인: `pip list | grep openpyxl`
4. 오류 메시지 전체 캡처

## 📊 예상 결과

분석이 완료되면:
```
======================================================================
용접선 로그 분석 도구 (Excel 버전)
======================================================================
로그 파일: rcs_20260204.log

데이터 추출 중... 완료! (3,804개)
거더 정보: B라인1번거더
날짜: 2026년 02월 04일

검증 수행 중... 완료!

======================================================================
📊 검증 결과 요약
======================================================================
총 케이스:    3,804개
✅ PASS:      99개 (2.6%)
❌ FAIL:      3,705개 (97.4%)

✅ Excel 저장 완료: 용접선검증_B라인1번거더_20260207_103441.xlsx
   - 탭: 요약, 전체 데이터, FAIL만, 통계
======================================================================
```

Excel 파일을 열어서 결과를 확인하세요!
