<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¡°íšŒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ - ê·¼ë¬´ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .result {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }

        .result.success {
            border-color: #28a745;
            background: #d4edda;
        }

        .result.error {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-box .label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-box .value {
            font-size: 32px;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #e0e0e0;
            font-size: 13px;
        }

        table td {
            padding: 10px 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        table tr:hover {
            background: #f8f9fa;
        }

        .back-link {
            text-align: center;
            margin-top: 30px;
        }

        .back-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ì¡°íšŒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>

        <!-- 1. í˜„ì¬ ë°ì´í„° í™•ì¸ -->
        <div class="section">
            <h2>1ï¸âƒ£ í˜„ì¬ ì €ì¥ëœ ë°ì´í„° í™•ì¸</h2>
            <button class="btn" onclick="checkCurrentData()">í˜„ì¬ ë°ì´í„° í™•ì¸</button>
            <button class="btn btn-danger" onclick="clearAllData()">ëª¨ë“  ë°ì´í„° ì‚­ì œ</button>
            <div id="currentDataResult"></div>
        </div>

        <!-- 2. ìƒ˜í”Œ ë°ì´í„° ìƒì„± -->
        <div class="section">
            <h2>2ï¸âƒ£ ìƒ˜í”Œ ë°ì´í„° ìƒì„±</h2>
            <button class="btn" onclick="generateSampleData(5)">5ê°œ ìƒì„±</button>
            <button class="btn" onclick="generateSampleData(20)">20ê°œ ìƒì„±</button>
            <button class="btn" onclick="generateSampleData(50)">50ê°œ ìƒì„±</button>
            <div id="sampleDataResult"></div>
        </div>

        <!-- 3. í•„í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ -->
        <div class="section">
            <h2>3ï¸âƒ£ í•„í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
            <button class="btn" onclick="testDateFilter()">ë‚ ì§œ í•„í„° í…ŒìŠ¤íŠ¸</button>
            <button class="btn" onclick="testPersonFilter()">ì¸ì› í•„í„° í…ŒìŠ¤íŠ¸</button>
            <button class="btn" onclick="testLocationFilter()">ì¥ì†Œ í•„í„° í…ŒìŠ¤íŠ¸</button>
            <div id="filterTestResult"></div>
        </div>

        <!-- 4. í†µê³„ -->
        <div class="section">
            <h2>4ï¸âƒ£ ë°ì´í„° í†µê³„</h2>
            <button class="btn" onclick="showStatistics()">í†µê³„ ë³´ê¸°</button>
            <div id="statsResult"></div>
        </div>

        <!-- 5. ì¡°íšŒ í˜ì´ì§€ ì—´ê¸° -->
        <div class="section">
            <h2>5ï¸âƒ£ ì¡°íšŒ í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h2>
            <p style="color: #666; margin-bottom: 15px;">
                ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•œ í›„ ì¡°íšŒ í˜ì´ì§€ì—ì„œ í™•ì¸í•˜ì„¸ìš”.
            </p>
            <button class="btn" onclick="openQueryPage()">ì¡°íšŒ í˜ì´ì§€ ì—´ê¸°</button>
        </div>

        <div class="back-link">
            <a href="/index.html">â† ëŒ€ì‹œë³´ë“œë¡œ</a>
        </div>
    </div>

    <script>
        // í˜„ì¬ ë°ì´í„° í™•ì¸
        function checkCurrentData() {
            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
            const resultDiv = document.getElementById('currentDataResult');

            if (records.length === 0) {
                resultDiv.innerHTML = `<div class="result error">
âŒ ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.

ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì…ë ¥ í˜ì´ì§€ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.
</div>`;
                return;
            }

            const preview = records.slice(0, 5).map((r, i) =>
                `${i + 1}. ${r.date} | ${r.name} | ${r.location} | ${r.checkIn} ~ ${r.checkOut}`
            ).join('\n');

            resultDiv.innerHTML = `<div class="result success">
âœ… ì´ ${records.length}ê°œì˜ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤.

ìµœê·¼ 5ê°œ ë¯¸ë¦¬ë³´ê¸°:
${preview}

ì „ì²´ ë°ì´í„° (JSON):
${JSON.stringify(records, null, 2)}
</div>`;
        }

        // ëª¨ë“  ë°ì´í„° ì‚­ì œ
        function clearAllData() {
            if (!confirm('âš ï¸ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                return;
            }

            localStorage.removeItem('workRecords');
            alert('âœ… ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            checkCurrentData();
        }

        // ìƒ˜í”Œ ë°ì´í„° ìƒì„±
        function generateSampleData(count) {
            const resultDiv = document.getElementById('sampleDataResult');
            resultDiv.innerHTML = '<div class="result">ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì¤‘...</div>';

            const employees = ['ì‹¬íƒœì–‘', 'ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜'];
            const locations = ['34bay Aë¼ì¸', '34bay Bë¼ì¸', '35bay Aë¼ì¸', '35bay Bë¼ì¸', 'ì‚¬ë¬´ì‹¤', 'íšŒì˜ì‹¤'];
            const workTypes = ['ì‹œìš´ì „', 'DeviceNet í†µì‹ ', 'ROBOTâ†”UI í…ŒìŠ¤íŠ¸', 'Hexagon ì¸¡ì •', 'ë¬¸ì œ í•´ê²°', 'ë¬¸ì„œ ì‘ì—…'];

            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');

            for (let i = 0; i < count; i++) {
                const date = new Date();
                date.setDate(date.getDate() - Math.floor(Math.random() * 60)); // ìµœê·¼ 60ì¼ ë‚´

                const checkInHour = 7 + Math.floor(Math.random() * 3); // 7-9ì‹œ
                const checkOutHour = 16 + Math.floor(Math.random() * 3); // 16-18ì‹œ

                const record = {
                    date: date.toISOString().split('T')[0],
                    name: employees[Math.floor(Math.random() * employees.length)],
                    location: locations[Math.floor(Math.random() * locations.length)],
                    checkIn: `${String(checkInHour).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`,
                    checkOut: `${String(checkOutHour).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`,
                    workType: workTypes[Math.floor(Math.random() * workTypes.length)],
                    notes: Math.random() > 0.5 ? 'í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…ë‹ˆë‹¤' : '-',
                    timestamp: new Date(date.getTime() + i * 1000).toISOString()
                };

                records.push(record);
            }

            localStorage.setItem('workRecords', JSON.stringify(records));

            resultDiv.innerHTML = `<div class="result success">
âœ… ${count}ê°œì˜ ìƒ˜í”Œ ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

ì´ ê¸°ë¡ ê°œìˆ˜: ${records.length}ê°œ

ìƒì„±ëœ ìƒ˜í”Œ ì˜ˆì‹œ:
${JSON.stringify(records[records.length - 1], null, 2)}
</div>`;
        }

        // ë‚ ì§œ í•„í„° í…ŒìŠ¤íŠ¸
        function testDateFilter() {
            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
            const resultDiv = document.getElementById('filterTestResult');

            if (records.length === 0) {
                resultDiv.innerHTML = '<div class="result error">âŒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¨¼ì € ìƒì„±í•˜ì„¸ìš”.</div>';
                return;
            }

            const today = new Date();
            const weekAgo = new Date();
            weekAgo.setDate(today.getDate() - 7);

            const startDate = weekAgo.toISOString().split('T')[0];
            const endDate = today.toISOString().split('T')[0];

            const filtered = records.filter(r => r.date >= startDate && r.date <= endDate);

            resultDiv.innerHTML = `<div class="result success">
âœ… ë‚ ì§œ í•„í„° í…ŒìŠ¤íŠ¸ ì™„ë£Œ

ê¸°ê°„: ${startDate} ~ ${endDate}
ì „ì²´: ${records.length}ê°œ
í•„í„°ë§ ê²°ê³¼: ${filtered.length}ê°œ

í•„í„°ë§ëœ ê¸°ë¡:
${filtered.map(r => `${r.date} | ${r.name} | ${r.location}`).join('\n')}
</div>`;
        }

        // ì¸ì› í•„í„° í…ŒìŠ¤íŠ¸
        function testPersonFilter() {
            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
            const resultDiv = document.getElementById('filterTestResult');

            if (records.length === 0) {
                resultDiv.innerHTML = '<div class="result error">âŒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            const targetPerson = 'ì‹¬íƒœì–‘';
            const filtered = records.filter(r => r.name === targetPerson);

            resultDiv.innerHTML = `<div class="result success">
âœ… ì¸ì› í•„í„° í…ŒìŠ¤íŠ¸ ì™„ë£Œ

ëŒ€ìƒ: ${targetPerson}
ì „ì²´: ${records.length}ê°œ
í•„í„°ë§ ê²°ê³¼: ${filtered.length}ê°œ

${targetPerson}ë‹˜ì˜ ê¸°ë¡:
${filtered.slice(0, 10).map(r => `${r.date} | ${r.location} | ${r.checkIn} ~ ${r.checkOut}`).join('\n')}
</div>`;
        }

        // ì¥ì†Œ í•„í„° í…ŒìŠ¤íŠ¸
        function testLocationFilter() {
            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
            const resultDiv = document.getElementById('filterTestResult');

            if (records.length === 0) {
                resultDiv.innerHTML = '<div class="result error">âŒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            const targetLocation = '34bay Aë¼ì¸';
            const filtered = records.filter(r => r.location === targetLocation);

            resultDiv.innerHTML = `<div class="result success">
âœ… ì¥ì†Œ í•„í„° í…ŒìŠ¤íŠ¸ ì™„ë£Œ

ëŒ€ìƒ: ${targetLocation}
ì „ì²´: ${records.length}ê°œ
í•„í„°ë§ ê²°ê³¼: ${filtered.length}ê°œ

${targetLocation}ì˜ ê¸°ë¡:
${filtered.slice(0, 10).map(r => `${r.date} | ${r.name} | ${r.checkIn} ~ ${r.checkOut}`).join('\n')}
</div>`;
        }

        // í†µê³„ ë³´ê¸°
        function showStatistics() {
            const records = JSON.parse(localStorage.getItem('workRecords') || '[]');
            const resultDiv = document.getElementById('statsResult');

            if (records.length === 0) {
                resultDiv.innerHTML = '<div class="result error">âŒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            // ì¸ì›ë³„ ì§‘ê³„
            const byPerson = {};
            records.forEach(r => {
                byPerson[r.name] = (byPerson[r.name] || 0) + 1;
            });

            // ì¥ì†Œë³„ ì§‘ê³„
            const byLocation = {};
            records.forEach(r => {
                byLocation[r.location] = (byLocation[r.location] || 0) + 1;
            });

            // ìµœê·¼ 7ì¼ ë°ì´í„°
            const today = new Date();
            const weekAgo = new Date();
            weekAgo.setDate(today.getDate() - 7);
            const recentCount = records.filter(r =>
                new Date(r.date) >= weekAgo
            ).length;

            const statsHtml = `
                <div class="stats">
                    <div class="stat-box">
                        <div class="label">ì´ ê¸°ë¡</div>
                        <div class="value">${records.length}</div>
                    </div>
                    <div class="stat-box">
                        <div class="label">ìµœê·¼ 7ì¼</div>
                        <div class="value">${recentCount}</div>
                    </div>
                    <div class="stat-box">
                        <div class="label">ë“±ë¡ ì¸ì›</div>
                        <div class="value">${Object.keys(byPerson).length}</div>
                    </div>
                    <div class="stat-box">
                        <div class="label">ì‚¬ìš© ì¥ì†Œ</div>
                        <div class="value">${Object.keys(byLocation).length}</div>
                    </div>
                </div>
                <div class="result" style="margin-top: 20px;">
<strong>ì¸ì›ë³„ í†µê³„:</strong>
${Object.entries(byPerson).map(([name, count]) => `${name}: ${count}ê±´`).join('\n')}

<strong>ì¥ì†Œë³„ í†µê³„:</strong>
${Object.entries(byLocation).map(([loc, count]) => `${loc}: ${count}ê±´`).join('\n')}
                </div>
            `;

            resultDiv.innerHTML = statsHtml;
        }

        // ì¡°íšŒ í˜ì´ì§€ ì—´ê¸°
        function openQueryPage() {
            window.open('ì¡°íšŒ.html', '_blank');
        }

        // ì´ˆê¸° ë¡œë“œ ì‹œ í˜„ì¬ ë°ì´í„° í™•ì¸
        window.addEventListener('DOMContentLoaded', function() {
            checkCurrentData();
        });
    </script>
</body>
</html>
