# 다음 단계 실행 가이드

**작성일**: 2025-12-07
**프로젝트**: S25016 SpGantry 1200
**현재 상태**: 코드 완성, RobotStudio 테스트 대기

---

## 🎯 다음 단계: RobotStudio 실제 테스트

### 현재까지 완료된 작업 ✅

1. ✅ WobjFloor 좌표계 통합
2. ✅ TCP 선택 기능 구현 (테스트/운영 모드)
3. ✅ 설정 정보 출력 기능
4. ✅ 버전 관리 완전히 정리
5. ✅ 문서화 완료 (6개 문서)

**코드 개발**: 100% 완료
**실제 테스트**: 0% 진행 ← **다음 단계**

---

## 📋 실행 순서 (Step-by-Step)

### 🔴 Step 1: RobotStudio 준비 (5분)

#### 1-1. TCPConfig_Task2.mod 로드

**RobotStudio 작업**:
```
1. RobotStudio 열기
2. Controller 탭 선택
3. RAPID 확장
4. T_ROB2 (TASK2) 선택
5. Program Modules 우클릭
6. Load Module... 클릭
7. 파일 선택:
   SpGantry_1200_526406_BACKUP_2025-11-21/
   RAPID/TASK2/PROGMOD/TCPConfig_Task2.mod
8. Open 클릭
9. 로드 확인: TCPConfig_Task2 모듈 표시됨
```

**예상 시간**: 2분

**확인 사항**:
- [ ] TCPConfig_Task2 모듈이 T_ROB2 > Program Modules에 표시됨
- [ ] tWeldTest1, tWeldTest2 변수 확인 가능

---

#### 1-2. FloorMonitor_Task2.mod 새로고침 (필요시)

**RobotStudio 작업**:
```
1. T_ROB2 > Program Modules > FloorMonitor_Task2 확인
2. 기존 모듈이 로드되어 있다면:
   - FloorMonitor_Task2 우클릭
   - Unload Module
   - Load Module... → FloorMonitor_Task2.mod 다시 로드
3. 또는 RobotStudio 재시작
```

**예상 시간**: 2분

**확인 사항**:
- [ ] FloorMonitor_Task2 모듈 헤더에 v1.1_251205 확인
- [ ] MonitorFloorAtHome_Task2 프로시저 존재 확인

---

#### 1-3. Program Check 실행

**RobotStudio 작업**:
```
1. RAPID 메뉴 선택
2. Program Check 클릭
3. 또는 Ctrl+Shift+F5
4. T_ROB1, T_ROB2 모두 체크
5. 결과 확인
```

**예상 시간**: 1분

**예상 결과**:
```
Program Check: OK
No errors found
```

**오류 발생 시**:
- "Reference to unknown entire data tWeldTest2"
  → TCPConfig_Task2.mod 로드 필요
- "Identifier too long"
  → FloorMonitor_Task2.mod v1.1 사용 확인

---

### 🟠 Step 2: 테스트 모드 실행 (7분)

#### 2-1. Robot2 홈 위치 이동

**RobotStudio 작업**:
```
1. T_ROB2 (TASK2) 선택
2. PP to Main 클릭
3. RAPID Test 창에서:
   % MoveToHomeAndCheckTCP
4. Start 버튼 클릭 (또는 Space)
5. TP 창에서 진행 상황 확인
```

**예상 시간**: 1분

**TP 출력 예시**:
```
========================================
Home Position Test (Robot2)
========================================
Moving to home position...
Home position reached!
...
Test completed!
Results saved to: HOME:/home_position_test_robot2.txt
```

**확인 사항**:
- [ ] Robot2가 홈 위치 [0,0,0,0,-90,0]에 도달
- [ ] tWeld2가 활성 도구로 설정됨
- [ ] 오류 없이 완료

---

#### 2-2. 테스트 모드로 측정 실행

**RobotStudio 작업**:
```
1. T_ROB2 (TASK2) 선택
2. PP to Main 클릭
3. RAPID Test 창에서:
   % MonitorFloorAtHome_Task2 \UseTestTCP
4. Start 버튼 클릭
5. TP 창에서 진행 상황 확인
```

**예상 시간**: 1분

**TP 출력 예시**:
```
========================================
Floor Coordinates at Home Position
Module: FloorMonitor_Task2 v1.1 (2025-12-05)
Executed from: TASK2
TCP Mode: TEST MODE
========================================
Robot1 TCP (WobjFloor):
  X = 9462.996 mm
  Y = 5300.002 mm
  Z = 1128.900 mm
  (using T_ROB1 active tool)
----------------------------------------
Robot2 tool0 (WobjFloor):
  X = 9951.000 mm
  Y = 5300.000 mm
  Z = 1128.900 mm
----------------------------------------
Robot2 tWeldTest2 (WobjFloor) - TEST MODE:
  X = 10251.000 mm (예상)
  Y = 5300.000 mm
  Z = ??? mm
  TCP offset: [300.00, 0, 300.00] mm
----------------------------------------
Results saved to: HOME:/floor_coordinates_at_home_task2.txt
```

**확인 사항**:
- [ ] "TCP Mode: TEST MODE" 표시됨
- [ ] Robot2 tWeldTest2 측정 완료
- [ ] 파일 저장 메시지 확인

---

#### 2-3. 테스트 결과 파일 확인

**RobotStudio 작업**:
```
1. Controller 탭
2. File System 확장
3. HOME: 클릭
4. floor_coordinates_at_home_task2.txt 더블클릭
5. 파일 내용 확인
```

**예상 시간**: 3분

**확인 항목**:

**헤더 섹션**:
```
========================================
Floor Coordinates at Home Position (TASK2)
========================================

Program Version: v1.1_251205
Module: FloorMonitor_Task2
Procedure: MonitorFloorAtHome_Task2

TCP Mode: TEST MODE  ← 확인!
  TCP Offset: [300.00, 0, 300.00] mm  ← 확인!

Date: 2025-12-07
Time: HH:MM:SS
```

**System Configuration 섹션**:
```
========================================
System Configuration
========================================

WobjFloor Definition:
  uframe.trans: [-9500, 5300, 2100] mm
  uframe.rot: [1, 0, 0, 0] (quaternion)
  Reference: R-axis center (GantryRob)

Tool Definitions (Current Mode: TEST MODE):  ← 확인!
  tWeldTest1 (Robot1):
    tframe.trans: [300, 0, 300] mm  ← 확인!
    tframe.rot: [1, 0, 0, 0] (quaternion)
    Note: Simplified for testing

  tWeldTest2 (Robot2):
    tframe.trans: [300, 0, 300] mm  ← 확인!
    tframe.rot: [1, 0, 0, 0] (quaternion)
    Note: Simplified for testing
```

**측정값 섹션**:
```
========================================
Robot2 - tWeldTest2 (Torch)
========================================
  X = 10251.000 mm (예상)
  Y = 5300.000 mm
  Z = ??? mm
  TCP offset: [300.00, 0, 300.00] mm
  Note: Read using tWeldTest2 directly from TASK2
```

**확인 사항**:
- [ ] TCP Mode: TEST MODE 표시
- [ ] TCP Offset: [300.00, 0, 300.00] mm
- [ ] System Configuration 섹션 존재
- [ ] Tool Definitions에 tWeldTest2 정보

---

#### 2-4. TCP 오프셋 검증 (계산)

**수동 계산**:

1. **Robot2 tool0 X 값 확인**:
   ```
   Robot2 tool0 X = _______ mm (파일에서 확인)
   ```

2. **Robot2 tWeldTest2 X 값 확인**:
   ```
   Robot2 tWeldTest2 X = _______ mm (파일에서 확인)
   ```

3. **차이 계산**:
   ```
   차이 = tWeldTest2 X - tool0 X
        = _______ - _______
        = _______ mm

   예상값: 300 mm
   오차: _______ mm
   ```

4. **합격 기준**:
   ```
   차이 = 300 ± 1 mm

   → PASS / FAIL
   ```

**예상 시간**: 2분

**확인 사항**:
- [ ] X축 오프셋 = 300 mm (±1mm 이내)
- [ ] Y축 오프셋 = 0 mm
- [ ] Z축 값 기록 (분석 필요)

---

### 🟡 Step 3: Z축 값 분석 (5분)

#### 3-1. Z축 측정값 확인

**파일에서 확인**:
```
Robot2 tool0 Z = _______ mm
Robot2 tWeldTest2 Z = _______ mm

차이 = tWeldTest2 Z - tool0 Z
     = _______ - _______
     = _______ mm
```

#### 3-2. Z축 예상 시나리오

**시나리오 A**: Z축 정방향
```
예상 차이 = +300 mm
측정 차이 = _______ mm
→ 일치 여부: _______
```

**시나리오 B**: Z축 역방향
```
예상 차이 = -300 mm
측정 차이 = _______ mm
→ 일치 여부: _______
```

**시나리오 C**: 회전 영향
```
이전 운영 모드:
  tool0 Z = 1128.900 mm
  tWeld2 Z = 797.070 mm
  차이 = -331.83 mm (TCP Z의 -1배)

현재 테스트 모드:
  tool0 Z = _______ mm
  tWeldTest2 Z = _______ mm
  차이 = _______ mm

비율 확인:
  차이 / TCP_Z = _______ / 300 = _______
  (예상: -1.0 또는 +1.0)
```

**확인 사항**:
- [ ] Z축 차이 부호 확인 (+/-)
- [ ] TCP Z 오프셋과의 비율
- [ ] 이전 결과와 일관성

---

### 🟢 Step 4: 운영 모드 실행 (5분)

#### 4-1. 운영 모드로 측정 실행

**RobotStudio 작업**:
```
1. T_ROB2 (TASK2) 선택
2. PP to Main 클릭
3. RAPID Test 창에서:
   % MonitorFloorAtHome_Task2
   (파라미터 없이!)
4. Start 버튼 클릭
5. TP 창에서 진행 상황 확인
```

**예상 시간**: 1분

**TP 출력 예시**:
```
========================================
Floor Coordinates at Home Position
Module: FloorMonitor_Task2 v1.1 (2025-12-05)
Executed from: TASK2
TCP Mode: PRODUCTION MODE  ← 확인!
========================================
Robot2 tWeld2 (WobjFloor) - PRODUCTION MODE:
  X = 10270.990 mm
  Y = 5300.000 mm
  Z = 797.070 mm
  TCP offset: [319.99, 0, 331.83] mm
```

**확인 사항**:
- [ ] "TCP Mode: PRODUCTION MODE" 표시됨
- [ ] Robot2 tWeld2 측정 완료
- [ ] 파일 저장 완료

---

#### 4-2. 운영 모드 결과 확인

**파일 확인**:
```
HOME:/floor_coordinates_at_home_task2.txt
```

**확인 항목**:
```
TCP Mode: PRODUCTION MODE  ← 확인!
  TCP Offset: [319.99, 0, 331.83] mm  ← 확인!

Tool Definitions (Current Mode: PRODUCTION MODE):  ← 확인!
  tWeld2 (Robot2):
    tframe.trans: [319.99, 0, 331.83] mm  ← 확인!
    Note: Production values

Robot2 - tWeld2 (Torch):
  X = 10270.990 mm
  Y = 5300.000 mm
  Z = 797.070 mm
  TCP offset: [319.99, 0, 331.83] mm
```

**이전 테스트 결과와 비교**:
```
이전 (2025-12-05):
  Robot2 tWeld2 X = 10270.990 mm
  Robot2 tWeld2 Z = 797.070 mm

현재 (2025-12-07):
  Robot2 tWeld2 X = _______ mm
  Robot2 tWeld2 Z = _______ mm

차이:
  dX = _______ mm
  dZ = _______ mm

→ 일치 여부: _______
```

**확인 사항**:
- [ ] TCP Mode: PRODUCTION MODE
- [ ] TCP Offset: [319.99, 0, 331.83] mm
- [ ] 이전 결과와 일치 (±0.1mm)

---

### 🔵 Step 5: 결과 비교 분석 (10분)

#### 5-1. 테스트 vs 운영 모드 비교표 작성

**측정값 기록**:

| 항목 | 테스트 모드 | 운영 모드 | 차이 | 비율 |
|------|------------|-----------|------|------|
| **TCP 정의** | | | | |
| TCP X (mm) | 300.00 | 319.99 | 19.99 | 1.0667 |
| TCP Y (mm) | 0.00 | 0.00 | 0.00 | - |
| TCP Z (mm) | 300.00 | 331.83 | 31.83 | 1.1061 |
| | | | | |
| **Robot2 tool0** | | | | |
| tool0 X (mm) | _______ | _______ | _______ | - |
| tool0 Y (mm) | _______ | _______ | _______ | - |
| tool0 Z (mm) | _______ | _______ | _______ | - |
| | | | | |
| **Robot2 tWeld** | | | | |
| tWeld X (mm) | _______ | _______ | _______ | - |
| tWeld Y (mm) | _______ | _______ | _______ | - |
| tWeld Z (mm) | _______ | _______ | _______ | - |
| | | | | |
| **TCP 오프셋 (계산)** | | | | |
| X 오프셋 (mm) | _______ | _______ | _______ | - |
| Y 오프셋 (mm) | _______ | _______ | _______ | - |
| Z 오프셋 (mm) | _______ | _______ | _______ | - |

#### 5-2. 일관성 검증

**검증 1: tool0 일치**
```
테스트 모드 tool0 X = _______ mm
운영 모드 tool0 X = _______ mm
차이 = _______ mm

예상: 0 mm (tool0는 모드와 무관)
→ PASS / FAIL
```

**검증 2: TCP 오프셋 비율**
```
X 오프셋 비율:
  운영 / 테스트 = _______ / _______ = _______
  예상: 319.99 / 300 = 1.0667
  → PASS / FAIL

Z 오프셋 비율:
  운영 / 테스트 = _______ / _______ = _______
  예상: 331.83 / 300 = 1.1061
  → PASS / FAIL
```

**검증 3: Z축 일관성**
```
테스트 모드:
  차이 / TCP_Z = _______ / 300 = _______

운영 모드:
  차이 / TCP_Z = _______ / 331.83 = _______

비율 일치 여부: _______
→ PASS / FAIL
```

---

## 📊 체크리스트 (전체)

### RobotStudio 준비
```
□ TCPConfig_Task2.mod 로드 완료
□ FloorMonitor_Task2.mod v1.1 확인
□ Program Check 통과 (오류 0개)
```

### 테스트 모드
```
□ MoveToHomeAndCheckTCP 실행 성공
□ MonitorFloorAtHome_Task2 \UseTestTCP 실행 성공
□ 결과 파일 생성 확인
□ TCP Mode: TEST MODE 확인
□ TCP Offset: [300, 0, 300] 확인
□ System Configuration 섹션 확인
□ X축 오프셋 = 300mm 검증
□ Z축 값 기록 및 분석
```

### 운영 모드
```
□ MonitorFloorAtHome_Task2 실행 성공
□ TCP Mode: PRODUCTION MODE 확인
□ TCP Offset: [319.99, 0, 331.83] 확인
□ 이전 결과와 일치 확인
```

### 결과 비교
```
□ 비교표 작성 완료
□ tool0 일치 검증
□ TCP 오프셋 비율 검증
□ Z축 일관성 검증
□ 최종 보고서 작성
```

---

## ⏱️ 예상 소요 시간

| 단계 | 내용 | 시간 | 누적 |
|------|------|------|------|
| Step 1 | RobotStudio 준비 | 5분 | 5분 |
| Step 2 | 테스트 모드 실행 | 7분 | 12분 |
| Step 3 | Z축 분석 | 5분 | 17분 |
| Step 4 | 운영 모드 실행 | 5분 | 22분 |
| Step 5 | 결과 비교 | 10분 | 32분 |

**총 예상 시간**: 약 30분

---

## 🚨 문제 발생 시 대응

### 오류 1: "Reference to unknown entire data tWeldTest2"

**원인**: TCPConfig_Task2.mod 미로드

**해결**:
1. T_ROB2 > Program Modules 확인
2. TCPConfig_Task2 모듈 없으면 Load Module
3. Program Check 재실행

---

### 오류 2: "Identifier too long"

**원인**: 구버전 FloorMonitor_Task2.mod 사용

**해결**:
1. FloorMonitor_Task2 Unload
2. v1.1 버전 Load
3. 모듈 헤더에서 "Version: v1.1_251205" 확인

---

### 오류 3: Program Check 실패

**원인**: RAPID 문법 오류

**해결**:
1. Output 창에서 오류 메시지 확인
2. 라인 번호 및 오류 내용 파악
3. 해당 파일 수정 또는 재로드

---

### 오류 4: 로봇이 홈 위치로 이동하지 않음

**원인**: 장애물 또는 안전 제한

**해결**:
1. Simulation/Virtual 모드 확인
2. 장애물 제거
3. Joint limits 확인
4. Manual mode로 홈 근처로 이동 후 재시도

---

## 📝 결과 보고 양식

### 테스트 실행 결과 (2025-12-07)

**실행 시간**: ___:___

#### 테스트 모드
```
TCP Mode: TEST MODE
TCP Offset: [300.00, 0, 300.00] mm

Robot2 tool0:
  X = _______ mm
  Y = _______ mm
  Z = _______ mm

Robot2 tWeldTest2:
  X = _______ mm
  Y = _______ mm
  Z = _______ mm

TCP 오프셋 (계산):
  dX = _______ mm (예상: 300 mm)
  dY = _______ mm (예상: 0 mm)
  dZ = _______ mm (분석 필요)
```

#### 운영 모드
```
TCP Mode: PRODUCTION MODE
TCP Offset: [319.99, 0, 331.83] mm

Robot2 tool0:
  X = _______ mm
  Y = _______ mm
  Z = _______ mm

Robot2 tWeld2:
  X = _______ mm
  Y = _______ mm
  Z = _______ mm

TCP 오프셋 (계산):
  dX = _______ mm (예상: 319.99 mm)
  dY = _______ mm (예상: 0 mm)
  dZ = _______ mm (예상: -331.83 mm)
```

#### 검증 결과
```
□ X축 오프셋 정확도: PASS / FAIL
□ TCP 비율 일치: PASS / FAIL
□ Z축 일관성: PASS / FAIL
□ 이전 결과 일치: PASS / FAIL

총평: _______________________
```

---

## 🎯 최종 목표

### 성공 기준

1. ✅ 테스트 모드 실행 성공
   - TCP Offset [300, 0, 300] 정확히 적용
   - X축 오프셋 300mm 검증 완료

2. ✅ 운영 모드 실행 성공
   - TCP Offset [319.99, 0, 331.83] 정확히 적용
   - 이전 결과와 일치

3. ✅ 두 모드 일관성 확인
   - tool0 값 동일
   - TCP 오프셋 비율 일치
   - Z축 동작 일관성

4. ✅ 설정 정보 출력 확인
   - System Configuration 섹션 존재
   - 모든 파라미터 표시

---

**작성 완료**: 2025-12-07
**다음 단계**: Step 1부터 순서대로 실행
**예상 완료**: 약 30분 후
