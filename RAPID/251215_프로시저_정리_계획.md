# MainModule 프로시저 정리 계획

**작성일**: 2025-12-15
**목적**: 테스트 과정에서 생성된 불필요한 프로시저 정리 및 체계화

---

## 📊 현재 프로시저 목록 (총 25개)

### 1. 메인 프로그램 (2개)
- `main()` - 원래 메인 프로그램 (용접 경로)
- `mainCopy()` - 백업 복사본

### 2. 홈 포지션 관련 (3개)
- `GoHome()` - OLD 홈 [0, -45, 0, 0, -45, 0]
- `GoHomeNew()` - NEW 홈 [0, -30, 0, 0, -60, 0]
- `GoHomeNewer()` - NEWER 홈 [0, -15, 0, 0, -75, 0] ⭐ **최종**

### 3. 홈 포지션 체크 (2개)
- `CheckNewHomePosition()` - NEW 홈 TCP 확인
- `CheckNewerHomePosition()` - NEWER 홈 TCP 확인 ⭐ **최종**

### 4. confdata 테스트 (3개)
- `CheckHomeConfdata()` - OLD 홈에서 confdata 확인
- `CheckNewHome_Confdata()` - NEW 홈에서 confdata 확인
- `CheckNewerHome_Confdata()` - NEWER 홈에서 confdata 확인 ⭐ **최종**

### 5. 좌표계 테스트 (2개) ⭐ **핵심**
- `CheckNewerHome_World()` - 3개 좌표계 (World, wobj0, Robot Base)
- `CheckNewerHome_AllCoords()` - 4개 좌표계 (+ WobjFloor) ⭐ **최종**

### 6. TCP 테스트 (6개) - 초기 테스트
- `TestTCP_Home()` - 홈에서 TCP 확인
- `TestTCP_Home_Plus50()` - 홈+50mm
- `TestTCP_188_0_1100()` - 특정 위치 테스트
- `TestTCP_200_0_1200()` - 특정 위치 테스트
- `TestTCP_188_100_1100()` - 특정 위치 테스트
- `CheckConfdata_188_100_1100()` - confdata 확인

### 7. 테스트 루틴 (5개) - 초기 실험
- `Routine1()` - 실험 루틴
- `Routine2()` - 실험 루틴
- `Routine3()` - 실험 루틴
- `Routine4()` - 실험 루틴
- `Routine5()` - 실험 루틴

### 8. 기타 (2개)
- `rFinal_200()` - 테스트 루틴
- `rFinal_200_244()` - 테스트 루틴

---

## 🗑️ 삭제 대상 프로시저 (15개)

### 이유: 초기 실험/테스트 단계에서만 사용, 더 이상 불필요

#### A. OLD/NEW 홈 관련 (삭제) - NEWER로 대체됨
- ❌ `GoHome()` - OLD 홈
- ❌ `GoHomeNew()` - NEW 홈
- ❌ `CheckNewHomePosition()` - NEW 홈 체크
- ❌ `CheckHomeConfdata()` - OLD 홈 confdata
- ❌ `CheckNewHome_Confdata()` - NEW 홈 confdata

#### B. 초기 TCP 테스트 (삭제) - 더 체계적인 테스트로 대체
- ❌ `TestTCP_Home()`
- ❌ `TestTCP_Home_Plus50()`
- ❌ `TestTCP_188_0_1100()`
- ❌ `TestTCP_200_0_1200()`
- ❌ `TestTCP_188_100_1100()`
- ❌ `CheckConfdata_188_100_1100()`

#### C. 실험 루틴 (삭제) - 용도 불명확
- ❌ `Routine1()`
- ❌ `Routine2()`
- ❌ `Routine3()`
- ❌ `Routine4()`
- ❌ `Routine5()`
- ❌ `rFinal_200()`
- ❌ `rFinal_200_244()`

#### D. 백업 (삭제) - 불필요한 복사본
- ❌ `mainCopy()`

---

## ✅ 유지할 프로시저 (8개)

### 메인 프로그램 (1개)
- ✅ `main()` - 실제 용접 프로그램

### 홈 포지션 (1개)
- ✅ `GoHomeNewer()` - NEWER 홈 [0, -15, 0, 0, -75, 0]

### 진단/체크 (3개)
- ✅ `CheckNewerHomePosition()` - NEWER 홈 TCP 확인
- ✅ `CheckNewerHome_Confdata()` - confdata 테스트 (X축)
- ✅ `CheckNewerHome_AllCoords()` - 4개 좌표계 테스트 (X축)

### 추가 예정 (3개) - Y/Z/R축 테스트
- 🆕 `CheckAxisY_AllCoords()` - Y축 이동 테스트
- 🆕 `CheckAxisZ_AllCoords()` - Z축 이동 테스트
- 🆕 `CheckAxisR_AllCoords()` - R축(회전) 이동 테스트

---

## 🆕 새로 추가할 Y/Z/R축 테스트 프로시저

### 1. CheckAxisY_AllCoords
**목적**: Y축 방향 이동 테스트
**경로**: (310, 0, 1050) → (310, 100, 1050) → (310, 200, 1050)
**출력**: `HOME:/axis_y_test_robot1.txt`

### 2. CheckAxisZ_AllCoords
**목적**: Z축 방향 이동 테스트
**경로**: (310, 0, 1050) → (310, 0, 1150) → (310, 0, 1250)
**출력**: `HOME:/axis_z_test_robot1.txt`

### 3. CheckAxisR_AllCoords
**목적**: 회전(방향) 변화 테스트
**경로**: (310, 0, 1050) 위치에서 방향만 변경
- Step 1: 기본 방향 (0°)
- Step 2: Z축 기준 45° 회전
- Step 3: Z축 기준 90° 회전
**출력**: `HOME:/axis_r_test_robot1.txt`

---

## 📋 정리 실행 계획

### Phase 1: 백업 생성 (안전)
1. 현재 MainModule.mod 전체 백업
2. 백업 위치: `MainModule_before_cleanup_251215.mod`

### Phase 2: 불필요한 프로시저 삭제
1. 15개 프로시저 삭제
2. 코드 줄 수: 약 1500줄 → 800줄 예상

### Phase 3: Y/Z/R축 테스트 프로시저 추가
1. `CheckAxisY_AllCoords` 추가 (약 150줄)
2. `CheckAxisZ_AllCoords` 추가 (약 150줄)
3. `CheckAxisR_AllCoords` 추가 (약 180줄)

### Phase 4: 버전 업데이트
- v2.4.0 → v3.0.0 (대규모 정리)
- 버전 히스토리 업데이트

---

## 📐 새 테스트 프로시저 상세 설계

### CheckAxisY_AllCoords

```rapid
PROC CheckAxisY_AllCoords()
    ! Y축 방향 이동 테스트
    ! From NEWER home [0, -15, 0, 0, -75, 0]
    ! Path: (310, 0, 1050) -> (310, 100, 1050) -> (310, 200, 1050)

    VAR robtarget step1_pose;
    VAR robtarget step2_pose;
    VAR robtarget step3_pose;
    VAR iodev logfile;
    VAR string filename := "HOME:/axis_y_test_robot1.txt";

    ! Step 1: (310, 0, 1050)
    ! Step 2: (310, 100, 1050)
    ! Step 3: (310, 200, 1050)

    ! 각 단계마다 4개 좌표계 출력:
    ! - World
    ! - wobj0
    ! - Robot Base
    ! - WobjFloor
ENDPROC
```

### CheckAxisZ_AllCoords

```rapid
PROC CheckAxisZ_AllCoords()
    ! Z축 방향 이동 테스트
    ! Path: (310, 0, 1050) -> (310, 0, 1150) -> (310, 0, 1250)

    ! 높이 변화에 따른 좌표계 변화 확인
    ! WobjFloor Z축 관계 검증
ENDPROC
```

### CheckAxisR_AllCoords

```rapid
PROC CheckAxisR_AllCoords()
    ! 회전 방향 테스트
    ! Position: (310, 0, 1050) 고정

    ! Orientation 변화:
    ! Step 1: [1, 0, 0, 0] (기본)
    ! Step 2: [0.707, 0, 0, 0.707] (Z축 45°)
    ! Step 3: [0, 0, 0, 1] (Z축 90°)

    ! confdata 변화 집중 관찰
ENDPROC
```

---

## ✅ 최종 프로시저 구성 (v3.0.0)

### 총 11개 프로시저

1. `main()` - 실제 용접 프로그램
2. `GoHomeNewer()` - NEWER 홈으로 이동
3. `CheckNewerHomePosition()` - 홈 TCP 확인
4. `CheckNewerHome_Confdata()` - X축 confdata 테스트
5. `CheckNewerHome_AllCoords()` - X축 4개 좌표계 테스트
6. `CheckAxisY_AllCoords()` - Y축 테스트 🆕
7. `CheckAxisZ_AllCoords()` - Z축 테스트 🆕
8. `CheckAxisR_AllCoords()` - 회전 테스트 🆕

**깔끔하고 체계적인 구조!**

---

## 📊 예상 효과

### Before (현재):
- 프로시저: 25개
- 코드 줄수: ~1500줄
- 혼란스러운 구조

### After (정리 후):
- 프로시저: 11개 ✅
- 코드 줄수: ~1200줄
- 명확한 목적별 구조
- 체계적인 테스트 프로시저

---

## 🎯 다음 단계

1. **승인 요청**: 삭제 대상 15개 프로시저 확인
2. **백업 생성**: 현재 MainModule.mod 백업
3. **프로시저 삭제**: 불필요한 15개 삭제
4. **Y/Z/R 프로시저 추가**: 3개 새 테스트 프로시저
5. **테스트 실행**: 새 프로시저 검증
6. **문서화**: v3.0.0 변경사항 정리

---

**진행 여부를 알려주시면 작업을 시작하겠습니다!**
