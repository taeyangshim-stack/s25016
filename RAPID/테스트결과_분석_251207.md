# 새 홈 포지션 테스트 결과 분석

**테스트 일시**: 2025-12-07 21:50-21:51
**홈 포지션**: [0, -45, 0, 0, -45, 0]
**프로젝트**: S25016 SpGantry 1200

---

## ✅ 테스트 결과 요약

### 1. 홈 포지션 도달 확인 ✅

**Robot1 (TASK1)**:
```
Target: [0, -45, 0, 0, -45, 0]
Actual: [0.000, -45.000, 0.000, -0.000, -45.000, -0.000]
→ ✅ 정확히 도달
```

**Robot2 (TASK2)**:
```
Target 표시: [0, 0, 0, 0, -90, 0]  ⚠️ 출력 오류
Actual: [0.000, -45.000, 0.000, -0.000, -45.000, -0.000]
→ ✅ 실제로는 정확히 도달
```

⚠️ **발견된 문제**: Robot2 txt 파일에 Target이 구버전으로 표시됨
- 코드는 이미 수정됨 `[[0,-45,0,0,-45,0],...]`
- txt 출력만 구버전 `[0, 0, 0, 0, -90, 0]`

---

### 2. TCP 오프셋 검증 ✅

**Robot1 tWeld1**:
```
Expected: [319.99, 0, 331.83] mm
Actual (wobj0): [319.989, -0.000, 331.831] mm
Actual (WobjFloor): [319.988, 0.000, -331.831] mm

오차:
  X: 0.001 mm ✅
  Y: 0.000 mm ✅
  Z: 0.001 mm ✅ (부호 차이는 좌표계 방향)
```

**Robot2 tWeld2**:
```
Expected: [319.99, 0, 331.83] mm
Actual (wobj0): [319.990, 0.000, 331.830] mm
Actual (WobjFloor): [319.990, 0.000, -331.830] mm

오차:
  X: 0.000 mm ✅
  Y: 0.000 mm ✅
  Z: 0.000 mm ✅
```

**결론**: ✅ TCP 오프셋 정확함 (오차 < 0.002mm)

---

### 3. 로봇 간 거리 측정 ✅

**tool0 (Flange) 차이**:
```
Robot1: [8984.419, 5300.004, 953.515] mm
Robot2: [9472.423, 5300.000, 953.513] mm

차이:
  dX = -488.004 mm
  dY = 0.004 mm
  dZ = 0.002 mm
  3D Distance = 488.004 mm

예상: 488 mm (R-axis 오프셋)
오차: 0.004 mm ✅
```

**tWeld (Torch) 차이**:
```
Robot1: [9304.407, 5300.005, 621.683] mm
Robot2: [9792.413, 5300.000, 621.683] mm

차이:
  dX = -488.006 mm
  dY = 0.005 mm
  dZ = 0.001 mm
  3D Distance = 488.006 mm

예상: 488 mm (tool0와 동일해야 함)
오차: 0.006 mm ✅
```

**결론**: ✅ 로봇 간 거리 정확함 (설계 값 488mm)

---

### 4. Z축 방향 분석 ✅

**WobjFloor에서 Z 오프셋**:
```
Robot1:
  tool0 Z: 953.515 mm
  tWeld1 Z: 621.683 mm
  차이: -331.832 mm (TCP Z의 -1배)

Robot2:
  tool0 Z: 953.513 mm
  tWeld2 Z: 621.683 mm
  차이: -331.830 mm (TCP Z의 -1배)
```

**분석**:
- TCP Z 오프셋: +331.83 mm
- WobjFloor Z 차이: -331.83 mm
- **결론**: WobjFloor의 Z축이 World Z축과 반대 방향

**이유**:
```
WobjFloor 정의:
  uframe.rot: [0, 1, 0, 0] (quaternion)
  → 180° 회전 (Z축 반전)
```

---

## 📊 새 홈 vs 이전 홈 비교

### Robot2 tool0 좌표 변화

**이전 홈** [0, 0, 0, 0, -90, 0]:
```
WobjFloor: [9951.000, 5300.000, 1128.900] mm
```

**새 홈** [0, -45, 0, 0, -45, 0]:
```
WobjFloor: [9472.423, 5300.000, 953.513] mm
```

**차이**:
```
dX = -478.577 mm
dY = 0.000 mm
dZ = -175.387 mm
```

**분석**: 축2, 축5를 -45°로 변경하여 로봇 자세가 바뀌었으므로 좌표 변화는 정상

---

### Robot2 tWeld2 좌표 변화

**이전 홈**:
```
WobjFloor: [10270.990, 5300.000, 797.070] mm
```

**새 홈**:
```
WobjFloor: [9792.413, 5300.000, 621.683] mm
```

**차이**:
```
dX = -478.577 mm (tool0 차이와 동일 ✅)
dY = 0.000 mm
dZ = -175.387 mm (tool0 차이와 동일 ✅)
```

**결론**: ✅ TCP 오프셋은 홈 포지션과 무관하게 일정함

---

## ⚠️ 발견된 문제

### 1. Robot2 txt 파일 출력 오류

**파일**: `HOME:/home_position_test_robot2.txt`

**문제**:
```
Target: [0, 0, 0, 0, -90, 0]  ⚠️ 구버전
Actual: [0.000, -45.000, ...]  ✅ 신버전
```

**원인**: HomePositionTest.mod (TASK2) 출력 부분 미수정

**확인 필요 라인**: Line 90-95

---

### 2. 버전 정보 누락

**Robot2 txt 파일**:
```
Program Version: v1.0_251205  ⚠️ v1.1_251207이어야 함
```

**확인 필요**: 모듈 로드 상태

---

### 3. 변경 이력 없음

모든 txt 파일에 변경 이력(Change History)이 없음

**추가 필요**:
```
Change History:
! v1.1_251207 - Changed home position to [0,-45,0,0,-45,0]
! v1.0_251205 - Initial version
```

---

## 🔧 수정 필요 사항

### HomePositionTest.mod (TASK2) 출력 섹션 확인

**확인 위치**:
```
Line 90-95 근처:
Write logfile, "Home Position (Joint angles):";
Write logfile, "  Target: [0, 0, 0, 0, -90, 0]";  ⚠️
```

**수정 필요**:
```
Write logfile, "  Target: [0, -45, 0, 0, -45, 0]";  ✅
```

---

## ✅ 검증 완료 항목

1. ✅ 홈 포지션 정확히 도달
2. ✅ TCP 오프셋 정확 (오차 < 0.002mm)
3. ✅ 로봇 간 거리 정확 (488mm)
4. ✅ Z축 방향 일관성 (-1배)
5. ✅ 간섭 없음 (테스트 성공)

---

## 📝 다음 조치

### 즉시 수정

```
□ HomePositionTest.mod (TASK2) 출력 섹션 확인
□ 버전 번호 v1.1_251207 확인
□ 변경 이력 txt 출력 추가
```

### 재테스트

```
□ TASK2 HomePositionTest 재실행
□ txt 파일 Target 확인
□ 버전 정보 확인
```

---

## ✨ 결론

### 성공 사항

1. ✅ 새 홈 포지션 [0, -45, 0, 0, -45, 0] 정상 동작
2. ✅ 로봇 간섭 해결됨
3. ✅ TCP 오프셋 정확성 검증 (오차 < 0.002mm)
4. ✅ 로봇 간 거리 정확 (488mm)
5. ✅ WobjFloor 좌표계 정상 동작

### 개선 필요

1. ⚠️ Robot2 txt 출력 Target 표시 오류
2. ⚠️ 버전 정보 일관성
3. ⚠️ 변경 이력 txt 출력 추가

---

**분석 완료**: 2025-12-07
**상태**: 테스트 성공, 일부 출력 개선 필요
**다음**: txt 출력 섹션 수정
