<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets 동기화 구현 가이드 - S25016</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .content {
            background: white;
            padding: 40px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }

        .success-box h3 {
            color: #155724;
            margin-bottom: 10px;
        }

        .step {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .step h2 {
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 20px;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
        }

        .code-block.inline {
            display: inline-block;
            padding: 4px 8px;
            font-size: 14px;
            background: #e9ecef;
            color: #495057;
            border-radius: 4px;
        }

        .warning {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .warning h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .info {
            background: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .info h4 {
            color: #0c5460;
            margin-bottom: 10px;
        }

        .checklist {
            list-style: none;
            margin: 20px 0;
        }

        .checklist li {
            padding: 12px 15px;
            background: white;
            border-left: 4px solid #28a745;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checklist li::before {
            content: "☑";
            color: #28a745;
            font-size: 20px;
        }

        .screenshot {
            background: #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }

        .back-link {
            text-align: center;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .back-link a {
            color: #667eea;
            text-decoration: none;
            font-size: 16px;
            font-weight: 600;
        }

        ol, ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✅ Google Sheets 동기화 구현 완료!</h1>
            <p>PC와 모바일 간 실시간 동기화 설정 가이드</p>
        </div>

        <div class="content">
            <div class="success-box">
                <h3>🎉 구현 완료!</h3>
                <p>
                    <strong>Google Sheets 연동 코드가 작성되었습니다.</strong><br>
                    이제 아래 단계를 따라 설정하면 PC와 핸드폰에서 동일한 인원/장소 목록을 사용할 수 있습니다.
                </p>
            </div>

            <!-- Step 1: Google Apps Script 업데이트 -->
            <div class="step">
                <h2>
                    <span class="step-number">1</span>
                    Google Apps Script 업데이트
                </h2>

                <p><strong>1-1. Apps Script 편집기 열기</strong></p>
                <ol>
                    <li>Google Sheets에서 기존 "S25016 근무관리" 스프레드시트 열기</li>
                    <li>상단 메뉴: <strong>확장 프로그램</strong> → <strong>Apps Script</strong> 클릭</li>
                </ol>

                <p style="margin-top: 20px;"><strong>1-2. 코드 업데이트</strong></p>
                <ol>
                    <li>왼쪽 파일 목록에서 <code class="code-block inline">코드.gs</code> 파일 선택</li>
                    <li>기존 코드 전체를 삭제하고 아래 내용으로 교체:</li>
                </ol>

                <div class="warning">
                    <h4>⚠️ 중요: 전체 코드 교체 필수</h4>
                    <p>
                        <code>/home/qwe/works/s25016/근무관리/GoogleAppsScript.js</code> 파일의 전체 내용을 복사하여 붙여넣으세요.<br>
                        새로 추가된 함수:
                    </p>
                    <ul>
                        <li><code>getEmployees()</code> - 인원 목록 조회</li>
                        <li><code>getLocations()</code> - 장소 목록 조회</li>
                        <li><code>doGet(e)</code> - GET 요청 라우팅 (수정됨)</li>
                    </ul>
                </div>

                <p style="margin-top: 20px;"><strong>1-3. 저장 및 권한 설정</strong></p>
                <ol>
                    <li>상단 디스크 아이콘 클릭 또는 <code class="code-block inline">Ctrl+S</code>로 저장</li>
                    <li>처음 실행 시 권한 승인 필요 (Google 계정 로그인)</li>
                </ol>
            </div>

            <!-- Step 2: 웹 앱 재배포 -->
            <div class="step">
                <h2>
                    <span class="step-number">2</span>
                    웹 앱 재배포
                </h2>

                <p><strong>2-1. 새 배포 만들기</strong></p>
                <ol>
                    <li>Apps Script 편집기 우측 상단: <strong>배포</strong> → <strong>배포 관리</strong></li>
                    <li>기존 배포 옆의 <strong>수정</strong> 아이콘 (연필 모양) 클릭</li>
                    <li><strong>새 버전</strong> 선택</li>
                    <li>설명 입력 (예: "인원/장소 동기화 기능 추가")</li>
                    <li><strong>배포</strong> 버튼 클릭</li>
                </ol>

                <div class="info">
                    <h4>💡 처음 배포하는 경우</h4>
                    <p>
                        <strong>배포</strong> → <strong>새 배포</strong> 선택 후:
                    </p>
                    <ul>
                        <li>유형 선택: <strong>웹 앱</strong></li>
                        <li>설명: "S25016 근무관리 API"</li>
                        <li>액세스 권한: <strong>나</strong></li>
                        <li>실행 계정: <strong>나</strong></li>
                        <li>액세스 권한 부여: <strong>모든 사용자</strong> (익명 포함)</li>
                    </ul>
                </div>

                <p style="margin-top: 20px;"><strong>2-2. 웹 앱 URL 복사</strong></p>
                <ol>
                    <li>배포 완료 후 표시되는 <strong>웹 앱 URL</strong> 복사</li>
                    <li>형식: <code>https://script.google.com/macros/s/ABC.../exec</code></li>
                </ol>

                <div class="warning">
                    <h4>⚠️ URL 확인</h4>
                    <p>
                        현재 입력.html과 조회.html에 설정된 URL:<br>
                        <code>https://script.google.com/macros/s/AKfycbygAg88Vk2cJwhkDUJQPn2OO18J9IhzvF0l85otx4khWGh8y4XxAJhpQlOZnVvATxQ/exec</code>
                    </p>
                    <p style="margin-top: 10px;">
                        새로 배포한 URL이 다르다면 아래 파일에서 <code>SCRIPT_URL</code> 값을 수정하세요.
                    </p>
                </div>
            </div>

            <!-- Step 3: Google Sheets 시트 생성 -->
            <div class="step">
                <h2>
                    <span class="step-number">3</span>
                    Google Sheets 시트 자동 생성 확인
                </h2>

                <p><strong>자동 생성 방식 (권장)</strong></p>
                <p>
                    처음으로 <code>getEmployees()</code> 또는 <code>getLocations()</code> API를 호출하면<br>
                    자동으로 시트가 생성되고 기본 데이터가 입력됩니다.
                </p>

                <div class="info">
                    <h4>💡 자동 생성되는 시트</h4>
                    <ul>
                        <li><strong>인원목록</strong> 시트 - A열에 이름 (심태양, 김철수, 이영희, 박민수)</li>
                        <li><strong>장소목록</strong> 시트 - A열에 장소 (34bay A/B라인, 35bay A/B라인, 사무실, 회의실)</li>
                    </ul>
                </div>

                <p style="margin-top: 20px;"><strong>테스트 방법</strong></p>
                <ol>
                    <li>브라우저에서 웹 앱 URL 접속:
                        <div class="code-block">https://your-script-url/exec?action=getEmployees</div>
                    </li>
                    <li>JSON 형식으로 인원 목록이 표시되면 성공</li>
                    <li>Google Sheets로 돌아가서 "인원목록", "장소목록" 시트 생성 확인</li>
                </ol>

                <div class="warning">
                    <h4>⚠️ 수동 생성 (선택사항)</h4>
                    <p>자동 생성이 작동하지 않는 경우 직접 만들 수 있습니다:</p>
                    <ol>
                        <li>Google Sheets 하단에서 <strong>+</strong> 클릭하여 새 시트 2개 추가</li>
                        <li>시트 이름을 <strong>인원목록</strong>, <strong>장소목록</strong>으로 변경</li>
                        <li>각 시트의 A1 셀에 헤더 입력 ("이름", "장소")</li>
                        <li>A2부터 데이터 입력</li>
                    </ol>
                </div>
            </div>

            <!-- Step 4: 프론트엔드 확인 -->
            <div class="step">
                <h2>
                    <span class="step-number">4</span>
                    프론트엔드 동작 확인
                </h2>

                <p><strong>수정된 파일 목록</strong></p>
                <ul class="checklist">
                    <li>근무관리/GoogleAppsScript.js - API 함수 추가</li>
                    <li>근무관리/입력.html - Google Sheets 연동</li>
                    <li>근무관리/조회.html - Google Sheets 연동</li>
                </ul>

                <p style="margin-top: 20px;"><strong>동작 흐름</strong></p>
                <div class="code-block">
페이지 로드
    ↓
fetchEmployeesFromSheet() 실행
    ↓
Google Sheets API 호출 (GET 요청)
    ↓
성공: LocalStorage 캐싱 → select 박스 채우기
실패: LocalStorage 또는 기본값 사용
                </div>

                <p style="margin-top: 20px;"><strong>브라우저 콘솔 로그 확인</strong></p>
                <ol>
                    <li>입력.html 또는 조회.html 페이지 열기</li>
                    <li>F12 눌러 개발자 도구 열기</li>
                    <li>Console 탭에서 다음 메시지 확인:
                        <div class="code-block">
✅ 인원 목록 로드 성공: (4) ["심태양", "김철수", "이영희", "박민수"]
✅ 장소 목록 로드 성공: (6) ["34bay A라인", "34bay B라인", ...]
                        </div>
                    </li>
                </ol>

                <div class="info">
                    <h4>💡 캐싱 메커니즘</h4>
                    <p>
                        Google Sheets에서 데이터를 가져온 후 LocalStorage에 캐싱합니다.<br>
                        다음 로드 시:
                    </p>
                    <ul>
                        <li>먼저 Google Sheets에서 최신 데이터 가져오기 시도</li>
                        <li>실패하면 LocalStorage 캐시 사용</li>
                        <li>둘 다 없으면 기본값 사용</li>
                    </ul>
                </div>
            </div>

            <!-- Step 5: 크로스 디바이스 테스트 -->
            <div class="step">
                <h2>
                    <span class="step-number">5</span>
                    크로스 디바이스 동기화 테스트
                </h2>

                <p><strong>테스트 시나리오</strong></p>
                <ol>
                    <li><strong>Google Sheets에서 데이터 수정</strong>
                        <ul>
                            <li>"인원목록" 시트에 새 이름 추가 (예: "홍길동")</li>
                            <li>저장 (자동 저장됨)</li>
                        </ul>
                    </li>
                    <li style="margin-top: 15px;"><strong>PC에서 확인</strong>
                        <ul>
                            <li>입력.html 페이지 새로고침</li>
                            <li>인원 선택박스에 "홍길동" 추가 확인</li>
                        </ul>
                    </li>
                    <li style="margin-top: 15px;"><strong>모바일에서 확인</strong>
                        <ul>
                            <li>핸드폰 브라우저에서 입력.html 접속</li>
                            <li>인원 선택박스에 "홍길동" 표시 확인</li>
                        </ul>
                    </li>
                </ol>

                <div class="success-box" style="margin-top: 20px;">
                    <h3>✅ 동기화 성공!</h3>
                    <p>
                        Google Sheets에서 수정한 내용이 모든 기기에서 동일하게 보이면 성공입니다!
                    </p>
                </div>
            </div>

            <!-- Troubleshooting -->
            <div class="step" style="border-left-color: #dc3545;">
                <h2>
                    <span class="step-number" style="background: #dc3545;">❗</span>
                    문제 해결
                </h2>

                <p><strong>문제 1: 인원/장소가 로드되지 않음</strong></p>
                <ul>
                    <li><strong>확인 사항:</strong>
                        <ul>
                            <li>웹 앱 URL이 올바른지 확인</li>
                            <li>Apps Script 재배포 완료 여부</li>
                            <li>브라우저 콘솔에서 에러 메시지 확인</li>
                        </ul>
                    </li>
                    <li><strong>해결:</strong>
                        <ul>
                            <li>F12 → Console 탭에서 에러 확인</li>
                            <li>CORS 에러: 웹 앱 배포 시 "모든 사용자" 액세스 권한 확인</li>
                            <li>404 에러: SCRIPT_URL 값 재확인</li>
                        </ul>
                    </li>
                </ul>

                <p style="margin-top: 20px;"><strong>문제 2: Google Sheets 시트가 자동 생성되지 않음</strong></p>
                <ul>
                    <li><strong>수동 생성:</strong> 위의 3단계 참고하여 직접 생성</li>
                    <li><strong>권한 확인:</strong> Apps Script가 스프레드시트에 대한 쓰기 권한이 있는지 확인</li>
                </ul>

                <p style="margin-top: 20px;"><strong>문제 3: PC에서는 되는데 모바일에서 안 됨</strong></p>
                <ul>
                    <li>모바일 브라우저 캐시 삭제 후 재시도</li>
                    <li>인터넷 연결 상태 확인</li>
                    <li>모바일에서도 F12 개발자 도구 사용 가능 (Chrome: 메뉴 → Desktop site)</li>
                </ul>

                <p style="margin-top: 20px;"><strong>문제 4: 변경사항이 반영되지 않음</strong></p>
                <ul>
                    <li>브라우저 새로고침 (Ctrl+F5 또는 캐시 삭제 후 새로고침)</li>
                    <li>LocalStorage 캐시 삭제:
                        <div class="code-block">
// 브라우저 Console에서 실행
localStorage.removeItem('workManagement_employees');
localStorage.removeItem('workManagement_locations');
location.reload();
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Next Steps -->
            <div class="info">
                <h4>🎯 다음 단계</h4>
                <p><strong>선택 1: 설정.html도 Google Sheets 연동</strong></p>
                <p>
                    현재 설정.html은 LocalStorage만 사용합니다.<br>
                    Google Sheets에 직접 쓰기 기능을 추가하려면:
                </p>
                <ul>
                    <li>GoogleAppsScript.js에 <code>addEmployee()</code>, <code>deleteEmployee()</code> 함수 추가</li>
                    <li>설정.html에서 POST 요청으로 데이터 추가/삭제</li>
                </ul>

                <p style="margin-top: 15px;"><strong>선택 2: 현재 방식 유지 (권장)</strong></p>
                <p>
                    Google Sheets를 직접 수정하는 것이 더 간단합니다.<br>
                    설정.html은 참고용으로 사용하거나 제거해도 됩니다.
                </p>
            </div>

            <div class="back-link">
                <a href="설정.html">← 설정 페이지로 돌아가기</a> |
                <a href="index.html">대시보드로 돌아가기</a>
            </div>
        </div>
    </div>
</body>
</html>
